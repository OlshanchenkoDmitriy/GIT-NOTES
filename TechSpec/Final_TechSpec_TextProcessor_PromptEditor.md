## Общее описание

Приложение представляет собой универсальный инструмент для пакетной обработки текста с возможностью создания и выполнения цепочек трансформаций. Пользователь загружает текстовые данные (файлы, списки строк) и применяет к ним последовательность настраиваемых операций: удаление символов, регулярные выражения, работа с регистром, дедупликация и другие. Каждая операция работает как независимый модуль, который можно включать/выключать, переставлять местами и настраивать отдельно. Результат можно пр...

Цель приложения — автоматизировать рутинную обработку текстовых данных через создание гибких, переиспользуемых цепочек трансформаций. Вместо ручного редактирования каждого файла или строки пользователь настраивает последовательность операций один раз, а затем применяет её к любому объёму данных. Приложение должно быть интуитивно понятным для непрограммистов, но достаточно мощным для сложных задач обработки текста.

Ключевая особенность — модульность: каждая операция независима, имеет свои настройки и может быть выполнена отдельно. Это позволяет пошагово отлаживать процесс обработки и создавать библиотеку готовых решений для типовых задач.

# Техническое задание: офлайн-приложение для обработки текста + PROMT Editor

---

## Часть 1. Базовое приложение — **Text Processor**

### 1. Матрица соответствия

| Требование | Статус | Примечание |
|------------|--------|------------|
| Полный офлайн режим | ✅ | SQLite + локальные операции |
| Две независимые версии | ✅ | React Native (expo-sqlite) + Tauri (SQLite) |
| Поштучное удаление символов | ✅ | UI с чекбоксами |
| Regex отдельно от поштучного | ✅ | Независимые шаги |
| Управление шагами | ✅ | Enable/disable + drag&drop + Run step |
| Пресеты в SQLite + JSON | ✅ | Хранение локально + экспорт/импорт |
| Предпросмотр + diff + Undo/Redo | ✅ | История + визуализация |

---

### 2. Краткий обзор  
Приложение для офлайн-обработки текста с модульной архитектурой. Цель — облегчить пользователям рутинные задачи по очистке, фильтрации и форматированию текстов. Каждая операция независима, настраивается отдельно, может выполняться по шагам. Конфигурации сохраняются в виде пресетов.

---

### 3. Основные функции (операции)

- **Удаление символов поштучно** (чекбоксы по символам → очищенный текст)  
- **Regex поиск/замена** (паттерн, замена, флаги → преобразованный текст)  
- **Работа с регистром** (UPPER, lower, Title Case, invert → текст в нужном стиле)  
- **Обрезка пробелов** (начало, конец, множественные → чистый текст)  
- **Дедупликация** (учёт регистра, сохранить первое/последнее → уникальные строки)  
- **Сортировка** (алфавит, длина, случайно → отсортированный список)  
- **Нумерация строк** (форматы 1., (1), 01, [1] → пронумерованные строки)  
- **Очистка пустых строк** (полностью пустые/только пробелы → компактный список)  
- **Префикс/суффикс** (текст до/после строки → обрамлённые строки)  
- **Заголовки строк** (извлечение первых N символов → список заголовков)  
- **Фильтрация по длине** *(optional)*  
- **Извлечение email/URL** *(optional)*  

---

### 4. Модули системы
- **Движок пайплайна** (выполняет операции)  
- **Хранилище пресетов (SQLite)**  
- **Редактор шагов (UI)**  
- **Предпросмотр/diff**  
- **Экспорт/импорт JSON**  

---

### 5. Управление шагами
1. Добавление шага → выбор из списка.  
2. Включение/выключение → чекбокс.  
3. Изменение порядка → drag&drop.  
4. Настройка параметров → панель справа.  
5. Run step → выполнить только выбранный шаг.  
6. Run all → выполнить все шаги.  
7. Save preset → сохранить конфигурацию.  

---

### 6. Данные и пресеты

**SQLite**  
- `presets` (id, name, description, created_at, last_used)  
- `preset_operations` (id, preset_id, type, position, enabled, params_json)  
- `operation_templates` (type, default_params_json, category)  
- `app_settings` (key, value)  
- `execution_history` (id, preset_id, input_size, output_size, exec_time, errors)  

**JSON**  
```json
{
  "preset_name": "Очистка email списка",
  "operations": [
    { "type": "remove_chars", "enabled": true, "params": {"chars": [";", ","]} },
    { "type": "deduplicate", "enabled": true, "params": {"case_sensitive": false} }
  ]
}
```

---

### 7. UX-требования
- Чекбоксы для символов.  
- Drag&drop для порядка.  
- Run step/Run all.  
- Панель предпросмотра (до/после).  
- Diff-подсветка.  
- Undo/Redo.  
- Подсказки по regex.  

---

### 8. Риски
- Большие файлы → замедление → ограниченный preview.  
- Regex-ошибки → зависания → таймаут + валидация.  
- Сложный UI → базовый/расширенный режим.  
- Переполнение undo/redo → лимиты и сжатие.  

---

### 9. Допущения
- Максимум 50MB файл *(assumption)*.  
- UTF-8 по умолчанию *(assumption)*.  
- Экспорт/импорт раз в неделю *(assumption)*.  

---

## Часть 2. **PROMT Editor (надстройка)**

### 1. Матрица соответствия

| Требование | Статус | Примечание |
|------------|--------|------------|
| Полный офлайн режим | ✅ | Всё локально |
| Отдельная вкладка | ✅ | PROMT Editor как раздел |
| Стандартизация структуры | ✅ | Авторазметка блоками |
| Удаление мусорных фраз | ✅ | Список стоп-фраз |
| Placeholder-система | ✅ | `[INPUT]`, `[OUTPUT]`, `[VAR]` |
| Поддержка Markdown | ✅ | Автовыравнивание |
| Пресеты для моделей | ✅ | GPT, Claude, Gemini, Sora |
| Preview/diff | ✅ | Сравнение промта до/после |

---

### 2. Краткий обзор
PROMT Editor — отдельный раздел, где пользователь приводит AI-промты к единообразному и структурированному виду. Он обеспечивает контроль формата, чистку текста от «мусора», поддержку Markdown и переменных. Подходит для тестирования и сравнения промтов для разных моделей.

---

### 3. Основные функции

- **Стандартизация структуры** (автоматическая вставка секций: Контекст, Задача, Формат, Ограничения).  
- **Удаление мусорных фраз** (редактируемый список «Конечно, вот пример», «как вы просили»).  
- **Форматирование Markdown** (заголовки, списки, код-блоки).  
- **Стандартизация символов/языка** (кавычки, тире, язык).  
- **Placeholder-система** (`[INPUT]`, `[OUTPUT]`, `[VARIABLE]`).  
- **Пресеты моделей** (разные структуры под GPT/Claude/Gemini/Sora).  

---

### 4. Модули системы
- **PROMT Engine** (расширение пайплайна для промтов).  
- **Prompt Presets (SQLite)**.  
- **UI вкладка PROMT Editor**.  
- **Preview + diff**.  
- **Импорт/экспорт JSON**.  

---

### 5. Управление шагами
1. Добавление шага (например, удаление стоп-фраз).  
2. Enable/disable чекбоксами.  
3. Изменение порядка drag&drop.  
4. Run step → запуск одного шага.  
5. Run all → запуск всех шагов.  
6. Save preset → сохранить как Prompt preset.  

---

### 6. Данные и пресеты

**SQLite (дополнение):**  
- `prompt_presets`: id, name, description, created_at  
- `prompt_operations`: preset_id, type, enabled, position, parameters_json  

**JSON пример:**  
```json
{
  "preset_name": "GPT prompt template",
  "operations": [
    { "type": "add_sections", "enabled": true, "params": {"sections": ["Context","Task","Format"]} },
    { "type": "remove_stop_phrases", "enabled": true, "params": {"phrases": ["Конечно, вот пример"]} }
  ],
  "metadata": {"model": "GPT-5"}
}
```

---

### 7. UX-требования
- Отдельная вкладка PROMT Editor.  
- Ввод промта + предпросмотр результата.  
- Diff подсветка изменений.  
- Группы настроек («Структура», «Форматирование», «Язык», «Фразы»).  
- Выпадающий список «Модель: GPT / Claude / Gemini / Sora».  

---

### 8. Риски
- Сложный интерфейс → нужен basic/advanced режим.  
- Разные требования моделей → шаблоны.  
- Regex/стоп-фразы → валидация + подсказки.  
- Пользователь может не заметить изменения → обязателен diff.  

---

### 9. Допущения
- Только текстовые промты *(assumption)*.  
- Макс. размер 50KB *(assumption)*.  
- Markdown как базовый формат *(assumption)*.

## Дополнительное общее описание

Приложение представляет собой универсальный инструмент для пакетной обработки текста с возможностью создания и выполнения цепочек трансформаций. Пользователь загружает текстовые данные (файлы, списки строк) и применяет к ним последовательность настраиваемых операций: удаление символов, регулярные выражения, работа с регистром, дедупликация и другие. Каждая операция работает как независимый модуль, который можно включать/выключать, переставлять местами и настраивать отдельно. Результат можно предварительно просмотреть, откатить изменения и сохранить как пресет для повторного использования. 

Цель приложения — автоматизировать рутинную обработку текстовых данных через создание гибких, переиспользуемых цепочек трансформаций. Вместо ручного редактирования каждого файла или строки пользователь настраивает последовательность операций один раз, а затем применяет её к любому объёму данных. Приложение должно быть интуитивно понятным для непрограммистов, но достаточно мощным для сложных задач обработки текста.

Ключевая особенность — модульность: каждая операция независима, имеет свои настройки и может быть выполнена отдельно. Это позволяет пошагово отлаживать процесс обработки и создавать библиотеку готовых решений для типовых задач.

## 3. Раздел Suno (планируемый)

В будущем приложение будет дополнено третьим разделом **Suno**, который предназначен для работы с генерацией и обработкой текстов для музыкальных проектов.  
На текущем этапе этот раздел является заготовкой и не содержит функционала. Его разработка планируется позже.